{
  "project": {
    "name": "Sixty Sales Dashboard",
    "template": "react-vite-supabase",
    "stack": {
      "framework": "react-vite",
      "database": "supabase",
      "auth": "supabase-auth"
    },
    "createdAt": "2026-02-23T00:00:00Z"
  },

  "features": [
    {
      "id": "always-on-agent",
      "name": "Always-On Sales Agent",
      "status": "complete",
      "prd": null,
      "consultReport": ".sixty/consult/always-on-sales-agent.md",
      "createdAt": "2026-02-23T00:00:00Z"
    }
  ],

  "stories": [
    {
      "id": "AOA-001",
      "feature": "always-on-agent",
      "title": "Create agent_persona table with RLS and RPCs",
      "type": "schema",
      "status": "complete",
      "priority": 1,
      "phase": 1,
      "dependencies": {
        "stories": [],
        "files": [],
        "schema": ["profiles"]
      },
      "blocks": ["AOA-004", "AOA-005", "AOA-006", "AOA-007", "AOA-008"],
      "parallelWith": ["AOA-002"],
      "acceptance": [
        "agent_persona table created with user_id PK, org_id, agent_name, tone, custom_instructions, proactive_frequency, focus_areas, quiet hours, morning_briefing_time/enabled",
        "RLS policies enforce user can only read/write own persona",
        "get_agent_persona(p_user_id) and upsert_agent_persona() RPCs created",
        "Check constraint: custom_instructions < 3KB"
      ],
      "estimatedMinutes": 15,
      "actualMinutes": null,
      "files": [
        "supabase/migrations/YYYYMMDD_agent_persona.sql"
      ],
      "designRef": null,
      "ticketId": null,
      "startedAt": null,
      "completedAt": null
    },
    {
      "id": "AOA-002",
      "feature": "always-on-agent",
      "title": "Extend notification_queue with triage columns",
      "type": "schema",
      "status": "complete",
      "priority": 2,
      "phase": 1,
      "dependencies": {
        "stories": [],
        "files": [],
        "schema": ["notification_queue"]
      },
      "blocks": ["AOA-003", "AOA-004"],
      "parallelWith": ["AOA-001"],
      "acceptance": [
        "Add columns: notification_type (text), triage_status enum ('pending'|'suppressed'|'batched'|'queued'|'delivered'|'failed'), delivery_channel ('slack_dm'|'in_app'|'email'|'batch'), entity_type, entity_id, batch_id (nullable FK), triaged_at, delivered_at",
        "Create notification_batches table with batch_type, item_count, items JSONB, scheduled_for, status",
        "Indexes on (user_id, triage_status), (entity_type, entity_id, created_at) for dedup lookups",
        "RLS policies: user sees own notifications only"
      ],
      "estimatedMinutes": 20,
      "actualMinutes": null,
      "files": [
        "supabase/migrations/YYYYMMDD_extend_notification_queue_triage.sql"
      ],
      "designRef": null,
      "ticketId": null,
      "startedAt": null,
      "completedAt": null
    },
    {
      "id": "AOA-003",
      "feature": "always-on-agent",
      "title": "Build notification-triage edge function",
      "type": "backend",
      "status": "complete",
      "priority": 3,
      "phase": 1,
      "dependencies": {
        "stories": ["AOA-002"],
        "files": [],
        "schema": ["notification_queue", "notification_batches"]
      },
      "blocks": ["AOA-004"],
      "parallelWith": [],
      "acceptance": [
        "New edge function notification-triage/index.ts processes pending notifications from queue",
        "Applies suppression rules: deduplication (same entity+type within 4h), cool-down (max 3/hour per type), quiet hours enforcement, empty-check suppression",
        "Priority matrix: routes HIGH to immediate delivery, MEDIUM to deliver-or-batch, LOW to batch",
        "Outputs decision: suppress / batch / deliver with chosen channel",
        "Updates triage_status and triaged_at on notification_queue rows"
      ],
      "estimatedMinutes": 30,
      "actualMinutes": null,
      "files": [
        "supabase/functions/notification-triage/index.ts",
        "supabase/functions/_shared/proactive/triageRules.ts"
      ],
      "designRef": null,
      "ticketId": null,
      "startedAt": null,
      "completedAt": null
    },
    {
      "id": "AOA-004",
      "feature": "always-on-agent",
      "title": "Wire runner.ts to insert into notification_queue via triage",
      "type": "backend",
      "status": "complete",
      "priority": 4,
      "phase": 1,
      "dependencies": {
        "stories": ["AOA-002", "AOA-003"],
        "files": ["supabase/functions/_shared/orchestrator/runner.ts"],
        "schema": ["notification_queue"]
      },
      "blocks": ["AOA-005"],
      "parallelWith": [],
      "acceptance": [
        "After each adapter StepResult, runner inserts to notification_queue with notification_type, priority, payload",
        "Feature flag: proactive_agent_config.triage_enabled — if false, falls through to existing direct Slack delivery",
        "Add triage_enabled boolean column to proactive_agent_config table",
        "Backward compatible: existing Slack adapters still work when triage disabled"
      ],
      "estimatedMinutes": 25,
      "actualMinutes": null,
      "files": [
        "supabase/functions/_shared/orchestrator/runner.ts",
        "supabase/migrations/YYYYMMDD_add_triage_enabled_flag.sql"
      ],
      "designRef": null,
      "ticketId": null,
      "startedAt": null,
      "completedAt": null
    },
    {
      "id": "AOA-005",
      "feature": "always-on-agent",
      "title": "Build morning briefing assembler edge function",
      "type": "backend",
      "status": "complete",
      "priority": 5,
      "phase": 2,
      "dependencies": {
        "stories": ["AOA-001", "AOA-004"],
        "files": ["supabase/functions/slack-morning-brief/index.ts"],
        "schema": ["notification_queue", "agent_persona"]
      },
      "blocks": ["AOA-012"],
      "parallelWith": ["AOA-006"],
      "acceptance": [
        "New edge function agent-morning-briefing/index.ts runs at user's configured time",
        "Queries batched/suppressed notifications from last 24h + deals + calendar + tasks",
        "Calls Haiku to generate natural-language briefing in user's persona tone",
        "Delivers via Slack DM (Block Kit) + writes to agent_activity for in-app feed",
        "Respects agent_persona.morning_briefing_enabled flag"
      ],
      "estimatedMinutes": 30,
      "actualMinutes": null,
      "files": [
        "supabase/functions/agent-morning-briefing/index.ts"
      ],
      "designRef": null,
      "ticketId": null,
      "startedAt": null,
      "completedAt": null
    },
    {
      "id": "AOA-006",
      "feature": "always-on-agent",
      "title": "Extend Slack DM delivery with persona voice injection",
      "type": "backend",
      "status": "complete",
      "priority": 6,
      "phase": 2,
      "dependencies": {
        "stories": ["AOA-001"],
        "files": ["supabase/functions/_shared/proactive/deliverySlack.ts"],
        "schema": ["agent_persona"]
      },
      "blocks": ["AOA-012"],
      "parallelWith": ["AOA-005"],
      "acceptance": [
        "deliverToSlack() loads agent_persona for recipient, applies tone to message header",
        "Agent name prefix in messages (e.g., '[Sixty] Your morning briefing')",
        "Interactive Slack buttons: 'Show details' / 'Dismiss' / 'Snooze 1h'",
        "Falls back to default persona ('Sixty', 'concise') if no agent_persona row exists"
      ],
      "estimatedMinutes": 20,
      "actualMinutes": null,
      "files": [
        "supabase/functions/_shared/proactive/deliverySlack.ts"
      ],
      "designRef": null,
      "ticketId": null,
      "startedAt": null,
      "completedAt": null
    },
    {
      "id": "AOA-007",
      "feature": "always-on-agent",
      "title": "Build enhanced in-app agent activity feed component",
      "type": "frontend",
      "status": "complete",
      "priority": 7,
      "phase": 2,
      "dependencies": {
        "stories": ["AOA-001"],
        "files": ["src/components/agent/AgentActivityFeed.tsx"],
        "schema": ["agent_activity"]
      },
      "blocks": ["AOA-008"],
      "parallelWith": ["AOA-005", "AOA-006"],
      "acceptance": [
        "Enhance existing AgentActivityFeed.tsx with real-time subscription to notification_queue + agent_activity",
        "Timeline view with natural-language summaries: '2h ago — Analyzed call with Acme Corp'",
        "Filter by type: meetings, deals, outreach, admin",
        "Mark as read, expand for details, empty state: 'Your agent is monitoring X deals, Y meetings'",
        "Lucide icons only (no emoji)"
      ],
      "estimatedMinutes": 25,
      "actualMinutes": null,
      "files": [
        "src/components/agent/AgentActivityFeed.tsx",
        "src/lib/hooks/useAgentActivityFeed.ts"
      ],
      "designRef": null,
      "ticketId": null,
      "startedAt": null,
      "completedAt": null
    },
    {
      "id": "AOA-008",
      "feature": "always-on-agent",
      "title": "Build agent status indicator in top bar",
      "type": "frontend",
      "status": "complete",
      "priority": 8,
      "phase": 2,
      "dependencies": {
        "stories": ["AOA-007"],
        "files": [],
        "schema": []
      },
      "blocks": ["AOA-012"],
      "parallelWith": [],
      "acceptance": [
        "Subtle indicator in app header showing agent state: 'Active — monitoring 12 deals' / 'Working — analyzing meeting' / 'Quiet hours'",
        "Unread badge count from agent_activity unread count RPC",
        "Clicking opens the AgentActivityFeed panel (Sheet with !top-16 !h-[calc(100vh-4rem)])",
        "Uses Lucide icons, matches existing top bar design patterns"
      ],
      "estimatedMinutes": 20,
      "actualMinutes": null,
      "files": [
        "src/components/agent/AgentStatusIndicator.tsx",
        "src/components/platform/TopBar.tsx"
      ],
      "designRef": null,
      "ticketId": null,
      "startedAt": null,
      "completedAt": null
    },
    {
      "id": "AOA-009",
      "feature": "always-on-agent",
      "title": "Build agent persona settings UI",
      "type": "frontend",
      "status": "complete",
      "priority": 9,
      "phase": 3,
      "dependencies": {
        "stories": ["AOA-001"],
        "files": [],
        "schema": ["agent_persona"]
      },
      "blocks": ["AOA-010"],
      "parallelWith": ["AOA-007", "AOA-008"],
      "acceptance": [
        "Settings page section: 'Your AI Agent' with fields: name, tone selector (4 presets + custom), proactive frequency, focus areas, quiet hours, morning briefing time",
        "Live preview: 'Here's how your agent will sound:' with sample message in selected tone",
        "Save via upsert_agent_persona RPC with toast feedback",
        "Uses existing Radix UI components from @/components/ui/"
      ],
      "estimatedMinutes": 25,
      "actualMinutes": null,
      "files": [
        "src/components/agent/AgentPersonaSettings.tsx",
        "src/lib/hooks/useAgentPersona.ts"
      ],
      "designRef": null,
      "ticketId": null,
      "startedAt": null,
      "completedAt": null
    },
    {
      "id": "AOA-010",
      "feature": "always-on-agent",
      "title": "Build first-run activation flow",
      "type": "frontend",
      "status": "complete",
      "priority": 10,
      "phase": 3,
      "dependencies": {
        "stories": ["AOA-009", "AOA-011"],
        "files": [],
        "schema": ["agent_persona"]
      },
      "blocks": ["AOA-012"],
      "parallelWith": [],
      "acceptance": [
        "Trigger: new user or user with no agent_persona record",
        "Step 1: 'Meet your AI agent' intro card with agent capabilities overview",
        "Step 2: Quick connect — verify Slack connected or prompt OAuth",
        "Step 3: Choose persona (name + tone, 3 presets + custom)",
        "Step 4: Agent processes last 7 days and delivers 'here's what I found' briefing",
        "Step 5: 'You'll hear from me tomorrow at [time]' confirmation"
      ],
      "estimatedMinutes": 30,
      "actualMinutes": null,
      "files": [
        "src/components/agent/AgentActivationFlow.tsx"
      ],
      "designRef": null,
      "ticketId": null,
      "startedAt": null,
      "completedAt": null
    },
    {
      "id": "AOA-011",
      "feature": "always-on-agent",
      "title": "Build initial-scan backfill edge function",
      "type": "backend",
      "status": "complete",
      "priority": 11,
      "phase": 3,
      "dependencies": {
        "stories": ["AOA-001"],
        "files": [],
        "schema": ["agent_persona", "deals", "meetings", "contacts", "tasks"]
      },
      "blocks": ["AOA-010"],
      "parallelWith": ["AOA-009"],
      "acceptance": [
        "New edge function agent-initial-scan/index.ts scans last 7 days of deals, meetings, contacts, tasks",
        "Identifies: stale deals, upcoming meetings, overdue tasks, contacts going cold",
        "Generates 'first impressions' briefing via Haiku in user's persona tone",
        "Delivers via Slack DM + in-app activity (limited to 50 most recent entities per category)"
      ],
      "estimatedMinutes": 25,
      "actualMinutes": null,
      "files": [
        "supabase/functions/agent-initial-scan/index.ts"
      ],
      "designRef": null,
      "ticketId": null,
      "startedAt": null,
      "completedAt": null
    },
    {
      "id": "AOA-012",
      "feature": "always-on-agent",
      "title": "Build triage analytics dashboard",
      "type": "frontend",
      "status": "pending",
      "priority": 12,
      "phase": 4,
      "dependencies": {
        "stories": ["AOA-005", "AOA-006", "AOA-008", "AOA-010"],
        "files": [],
        "schema": ["notification_queue"]
      },
      "blocks": ["AOA-014"],
      "parallelWith": ["AOA-013"],
      "acceptance": [
        "Agent effectiveness metrics: notifications sent, suppressed, batched counts",
        "Delivery stats: action taken rate",
        "Cost tracking: credits consumed by agent per day/week",
        "'Your agent saved you X hours this week' headline stat"
      ],
      "estimatedMinutes": 25,
      "actualMinutes": null,
      "files": [
        "src/components/agent/AgentAnalyticsDashboard.tsx"
      ],
      "designRef": null,
      "ticketId": null,
      "startedAt": null,
      "completedAt": null
    },
    {
      "id": "AOA-013",
      "feature": "always-on-agent",
      "title": "Build notification preferences UI",
      "type": "frontend",
      "status": "pending",
      "priority": 13,
      "phase": 4,
      "dependencies": {
        "stories": ["AOA-001", "AOA-003"],
        "files": [],
        "schema": ["agent_persona", "proactive_agent_config"]
      },
      "blocks": ["AOA-014"],
      "parallelWith": ["AOA-012"],
      "acceptance": [
        "Per-notification-type controls: enable/disable, delivery channel, frequency",
        "Quiet hours configuration with timezone picker",
        "'Notification volume' slider: aggressive / balanced / quiet",
        "Preview of what each setting changes"
      ],
      "estimatedMinutes": 25,
      "actualMinutes": null,
      "files": [
        "src/components/agent/NotificationPreferences.tsx"
      ],
      "designRef": null,
      "ticketId": null,
      "startedAt": null,
      "completedAt": null
    },
    {
      "id": "AOA-014",
      "feature": "always-on-agent",
      "title": "End-to-end testing and hardening",
      "type": "test",
      "status": "complete",
      "priority": 14,
      "phase": 4,
      "dependencies": {
        "stories": ["AOA-012", "AOA-013"],
        "files": [],
        "schema": []
      },
      "blocks": [],
      "parallelWith": [],
      "acceptance": [
        "Test: morning briefing assembly + delivery pipeline",
        "Test: triage suppression rules (dedup, cooldown, quiet hours)",
        "Test: first-run activation flow end-to-end",
        "Test: persona injection into Slack messages"
      ],
      "estimatedMinutes": 30,
      "actualMinutes": null,
      "files": [
        "supabase/functions/_shared/proactive/__tests__/triageRules.test.ts",
        "supabase/functions/_shared/proactive/__tests__/deliverySlackPersona.test.ts"
      ],
      "designRef": null,
      "ticketId": null,
      "startedAt": null,
      "completedAt": null
    }
  ],

  "execution": {
    "totalStories": 14,
    "completedStories": 14,
    "currentFeature": "always-on-agent",
    "lastUpdated": "2026-02-23T00:17:00Z"
  }
}
