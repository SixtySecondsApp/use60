---
name: slack-blocks
description: Create perfectly structured, engaging, and interactive Slack Block Kit messages for sales assistant bots. Use when building Slack notifications, alerts, dashboards, or interactive messages for sales workflows including deal updates, lead alerts, meeting reminders, pipeline summaries, activity notifications, approval requests, and any sales-related Slack bot messaging.
globs:
  - "**/slack*.ts"
  - "**/slackBlocks.ts"
  - "**/*slack*.tsx"
  - "**/functions/slack-*/**"
---

# Slack Blocks for Sales Bots

Create visually stunning, interactive Slack messages that drive engagement and action.

## Core Principles

1. **Scannable**: Lead with the most important info. Sales reps skim, they don't read.
2. **Actionable**: Every message should have a clear next step with interactive buttons.
3. **Contextual**: Include just enough data to make decisions without leaving Slack.
4. **Branded**: Use consistent emoji patterns for instant recognition.

## Quick Reference

### Block Structure

```json
{
  "blocks": [...],           // Visual layout (required)
  "attachments": [...]       // Colored sidebar + fallback (optional)
}
```

### Essential Block Types

| Block | Use For |
|-------|---------|
| `header` | Titles, alerts (emoji + bold text) |
| `section` | Main content, key-value pairs, images |
| `actions` | Buttons, dropdowns, date pickers |
| `divider` | Visual separation |
| `context` | Timestamps, metadata, subtle info |
| `rich_text` | Formatted lists, links, mentions |

## Sales Message Patterns

### Pattern 1: Deal Alert (High Priority)

```json
{
  "blocks": [
    {
      "type": "header",
      "text": {"type": "plain_text", "text": "ğŸ”¥ Hot Lead Alert", "emoji": true}
    },
    {
      "type": "section",
      "fields": [
        {"type": "mrkdwn", "text": "*Company*\nAcme Corp"},
        {"type": "mrkdwn", "text": "*Value*\nÂ£45,000"},
        {"type": "mrkdwn", "text": "*Source*\nInbound Demo"},
        {"type": "mrkdwn", "text": "*Score*\n92/100 ğŸ¯"}
      ]
    },
    {
      "type": "section",
      "text": {"type": "mrkdwn", "text": "*Signal:* Downloaded pricing guide + viewed case studies 3x today"}
    },
    {
      "type": "actions",
      "elements": [
        {"type": "button", "text": {"type": "plain_text", "text": "ğŸ“ Call Now"}, "style": "primary", "action_id": "call_lead"},
        {"type": "button", "text": {"type": "plain_text", "text": "ğŸ“§ Send Email"}, "action_id": "send_email"},
        {"type": "button", "text": {"type": "plain_text", "text": "ğŸ‘€ View Profile"}, "action_id": "view_profile"}
      ]
    },
    {
      "type": "context",
      "elements": [
        {"type": "mrkdwn", "text": "Assigned to <@U123> â€¢ Last activity: 5 mins ago"}
      ]
    }
  ]
}
```

### Pattern 2: Daily Pipeline Summary

```json
{
  "blocks": [
    {
      "type": "header",
      "text": {"type": "plain_text", "text": "ğŸ“Š Your Pipeline Today", "emoji": true}
    },
    {
      "type": "section",
      "text": {"type": "mrkdwn", "text": "*Pipeline Value:* Â£1.2M across 24 deals"}
    },
    {"type": "divider"},
    {
      "type": "section",
      "text": {"type": "mrkdwn", "text": "ğŸŸ¢ *Closing This Week (3)*\nâ€¢ Acme Corp â€” Â£45K â€” Contract sent\nâ€¢ Beta Inc â€” Â£28K â€” Final negotiation\nâ€¢ Gamma Ltd â€” Â£15K â€” Awaiting signature"}
    },
    {
      "type": "section",
      "text": {"type": "mrkdwn", "text": "ğŸŸ¡ *Needs Attention (2)*\nâ€¢ Delta Corp â€” No response 7 days\nâ€¢ Epsilon Ltd â€” Stalled at proposal"}
    },
    {
      "type": "actions",
      "elements": [
        {"type": "button", "text": {"type": "plain_text", "text": "View Full Pipeline"}, "style": "primary", "action_id": "view_pipeline"},
        {"type": "button", "text": {"type": "plain_text", "text": "Schedule Follow-ups"}, "action_id": "schedule_followups"}
      ]
    }
  ]
}
```

### Pattern 3: Meeting Reminder

```json
{
  "blocks": [
    {
      "type": "header",
      "text": {"type": "plain_text", "text": "ğŸ“… Meeting in 15 mins", "emoji": true}
    },
    {
      "type": "section",
      "fields": [
        {"type": "mrkdwn", "text": "*With*\nSarah Chen, VP Sales @ Acme"},
        {"type": "mrkdwn", "text": "*Deal*\nÂ£45,000 Enterprise"},
        {"type": "mrkdwn", "text": "*Stage*\nNegotiation"},
        {"type": "mrkdwn", "text": "*Meeting*\nContract Review"}
      ],
      "accessory": {
        "type": "image",
        "image_url": "https://example.com/avatar.png",
        "alt_text": "Sarah Chen"
      }
    },
    {
      "type": "section",
      "text": {"type": "mrkdwn", "text": "*Quick Prep:*\nâ€¢ They asked about SOC2 compliance last call\nâ€¢ Budget approved, timeline is Q1\nâ€¢ Key objection: Implementation time"}
    },
    {
      "type": "actions",
      "elements": [
        {"type": "button", "text": {"type": "plain_text", "text": "ğŸ¥ Join Call"}, "style": "primary", "url": "https://zoom.us/j/123", "action_id": "join_call"},
        {"type": "button", "text": {"type": "plain_text", "text": "ğŸ“‹ View Notes"}, "action_id": "view_notes"},
        {"type": "button", "text": {"type": "plain_text", "text": "â° Snooze 5m"}, "action_id": "snooze"}
      ]
    }
  ]
}
```

### Pattern 4: Win/Loss Notification

```json
{
  "blocks": [
    {
      "type": "header",
      "text": {"type": "plain_text", "text": "ğŸ‰ DEAL WON!", "emoji": true}
    },
    {
      "type": "section",
      "text": {"type": "mrkdwn", "text": "*Acme Corporation* just signed!\n\nğŸ’° *Â£45,000* Annual Contract\nğŸ“ˆ *18% above* target price\nâ±ï¸ *23 days* sales cycle"}
    },
    {"type": "divider"},
    {
      "type": "section",
      "text": {"type": "mrkdwn", "text": "*Winning Factors:*\nâœ… ROI calculator demo\nâœ… Customer reference call\nâœ… Fast legal turnaround"}
    },
    {
      "type": "context",
      "elements": [
        {"type": "mrkdwn", "text": "Closed by <@U123> â€¢ Team quota: 78% â†’ 89%"}
      ]
    },
    {
      "type": "actions",
      "elements": [
        {"type": "button", "text": {"type": "plain_text", "text": "ğŸŠ Celebrate"}, "action_id": "celebrate"},
        {"type": "button", "text": {"type": "plain_text", "text": "ğŸ“ Add to Case Studies"}, "action_id": "case_study"}
      ]
    }
  ]
}
```

### Pattern 5: Approval Request

```json
{
  "blocks": [
    {
      "type": "header",
      "text": {"type": "plain_text", "text": "âš¡ Discount Approval Needed", "emoji": true}
    },
    {
      "type": "section",
      "fields": [
        {"type": "mrkdwn", "text": "*Deal*\nAcme Corp Enterprise"},
        {"type": "mrkdwn", "text": "*Rep*\n<@U123>"},
        {"type": "mrkdwn", "text": "*Requested*\n25% discount"},
        {"type": "mrkdwn", "text": "*Value*\nÂ£45K â†’ Â£33.75K"}
      ]
    },
    {
      "type": "section",
      "text": {"type": "mrkdwn", "text": "*Justification:*\n3-year commit, expansion potential to 500+ seats, competitive pressure from Competitor X"}
    },
    {
      "type": "actions",
      "elements": [
        {"type": "button", "text": {"type": "plain_text", "text": "âœ… Approve"}, "style": "primary", "action_id": "approve"},
        {"type": "button", "text": {"type": "plain_text", "text": "âŒ Deny"}, "style": "danger", "action_id": "deny"},
        {"type": "button", "text": {"type": "plain_text", "text": "ğŸ’¬ Discuss"}, "action_id": "discuss"}
      ]
    },
    {
      "type": "context",
      "elements": [
        {"type": "mrkdwn", "text": "â° Expires in 4 hours â€¢ Deal closes Friday"}
      ]
    }
  ]
}
```

## Interactive Elements

### Buttons

```json
// Primary action (green)
{"type": "button", "text": {"type": "plain_text", "text": "Approve"}, "style": "primary", "action_id": "approve"}

// Danger action (red)
{"type": "button", "text": {"type": "plain_text", "text": "Delete"}, "style": "danger", "action_id": "delete"}

// Default (gray) - use for secondary actions
{"type": "button", "text": {"type": "plain_text", "text": "View Details"}, "action_id": "view"}

// Link button (opens URL) - NO value prop when url is present
{"type": "button", "text": {"type": "plain_text", "text": "Open CRM"}, "url": "https://crm.example.com", "action_id": "open_crm"}
```

### Dropdown Menus

```json
{
  "type": "static_select",
  "placeholder": {"type": "plain_text", "text": "Select stage"},
  "action_id": "update_stage",
  "options": [
    {"text": {"type": "plain_text", "text": "Discovery"}, "value": "discovery"},
    {"text": {"type": "plain_text", "text": "Proposal"}, "value": "proposal"},
    {"text": {"type": "plain_text", "text": "Negotiation"}, "value": "negotiation"}
  ]
}
```

### Date Picker

```json
{
  "type": "datepicker",
  "action_id": "select_date",
  "placeholder": {"type": "plain_text", "text": "Select close date"}
}
```

### Overflow Menu (for secondary actions)

```json
{
  "type": "overflow",
  "action_id": "more_options",
  "options": [
    {"text": {"type": "plain_text", "text": "Edit"}, "value": "edit"},
    {"text": {"type": "plain_text", "text": "Archive"}, "value": "archive"},
    {"text": {"type": "plain_text", "text": "Delete"}, "value": "delete"}
  ]
}
```

## Emoji Patterns for Sales Bots

Use consistent emoji for instant recognition:

| Category | Emoji | Use For |
|----------|-------|---------|
| Urgency | ğŸ”¥ ğŸš¨ âš¡ | Hot leads, urgent actions |
| Success | ğŸ‰ âœ… ğŸ† ğŸ’° | Wins, completions, revenue |
| Warning | âš ï¸ ğŸŸ¡ â° | At-risk deals, deadlines |
| Status | ğŸŸ¢ ğŸŸ¡ ğŸ”´ | Health indicators |
| Actions | ğŸ“ ğŸ“§ ğŸ“… ğŸ“‹ | Call, email, meeting, notes |
| Data | ğŸ“Š ğŸ“ˆ ğŸ’¹ | Reports, analytics, trends |

## Slack Block Kit Limits (CRITICAL)

**Always respect these limits to avoid `invalid_blocks` errors:**

| Element | Limit |
|---------|-------|
| Header text | 150 characters |
| Section text | 3000 characters |
| Button text | 75 characters |
| Button value | 2000 characters |
| Context element text | 500 characters |
| Blocks per message | 50 blocks |
| Actions per block | 25 elements |
| Fields per section | 10 fields |

## Design Rules

1. **Max 3 buttons** per actions block (more creates decision fatigue)
2. **One primary button** per message (clear CTA hierarchy)
3. **Fields for pairs** - use section fields for label:value pairs
4. **Headers for alerts** - skip headers for routine updates
5. **Context for metadata** - timestamps, attributions at bottom
6. **Dividers sparingly** - only when switching topics
7. **URL buttons omit value** - don't include `value` when `url` is present

## Common Mistakes to Avoid

âŒ **Too many blocks** - Keep under 10 blocks total
âŒ **Wall of text** - Break into scannable chunks
âŒ **No clear action** - Always include at least one button
âŒ **Missing context** - Include who/when/why metadata
âŒ **Inconsistent emoji** - Stick to your emoji vocabulary
âŒ **Button text too long** - Max 24 characters recommended
âŒ **Value + URL on same button** - Slack may reject this
âŒ **Exceeding character limits** - Truncate long text before building blocks

## Our Implementation

See `supabase/functions/_shared/slackBlocks.ts` for our Block Kit builder functions:

- `header(text)` - Creates header block (auto-truncates to 150 chars)
- `section(text)` - Creates section with mrkdwn (auto-truncates to 3000 chars)
- `sectionWithButton(text, buttonText, actionId, value, style)` - Section with accessory button
- `context(elements)` - Creates context block
- `actions(buttons)` - Creates actions block with buttons
- `divider()` - Creates divider block
- `buildMeetingDebriefMessage(data)` - Full meeting debrief message
- `buildDailyDigestMessage(data)` - Daily standup digest
- `buildMeetingPrepMessage(data)` - Pre-meeting prep card
- `buildDealRoomMessage(data)` - Deal room creation
