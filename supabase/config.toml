# Supabase Project Configuration
# This file is used by Supabase CLI for local development and branching

[project]
# Project reference ID - set via: supabase link --project-ref <id>
# project_id = "your-project-ref-id"

# Database Configuration
[db]
# Connection pooler settings for branching
# Development branch uses connection pooler for better performance
pooler = { enabled = true, port = 6543, pool_mode = "transaction" }

[functions.process-single-activity]
enabled = true
verify_jwt = true
# import_map = "./functions/process-single-activity/deno.json"
# Uncomment to specify a custom file path to the entrypoint.
# Supported file extensions are: .ts, .js, .mjs, .jsx, .tsx
entrypoint = "./functions/process-single-activity/index.ts"
# Specifies static files to be bundled with the function. Supports glob patterns.
# For example, if you want to serve static HTML pages in your function:
# static_files = [ "./functions/process-single-activity/*.html" ]

[functions.savvycal-leads-webhook]
verify_jwt = false

# JustCall integration (webhooks + OAuth callback must accept non-JWT requests)
[functions.justcall-webhook]
verify_jwt = false

[functions.justcall-oauth-callback]
verify_jwt = false

# Audio proxy is consumed by <audio> tags (Range requests) so we allow token via query string
[functions.proxy-justcall-recording]
verify_jwt = false

[functions.justcall-search]
verify_jwt = false

# Internal automation triggered by webhooks / server-side jobs.
# We disable platform JWT verification and enforce auth inside the function
# (service role bearer token, optional CRON_SECRET, or user JWT checks).
[functions.process-lead-prep]
verify_jwt = false

[functions.enrich-company]
verify_jwt = false

# HubSpot integration (OAuth callback + webhooks must accept non-JWT requests)
[functions.hubspot-oauth-callback]
verify_jwt = false

[functions.hubspot-webhook]
verify_jwt = false

# Health check endpoint - public access for monitoring services
[functions.health]
verify_jwt = false

# Copilot (called directly from browser; must allow CORS preflight without platform JWT gate)
[functions.api-copilot]
verify_jwt = false

# Gmail (called directly from browser; uses in-function auth + allowlist-based CORS)
[functions.google-gmail]
verify_jwt = false

# Slack interactive webhooks (buttons, modals) - uses Slack signature verification
[functions.slack-interactive]
verify_jwt = false

# HITL test endpoint - for testing approval flows
[functions.test-hitl]
verify_jwt = false

# Fireflies integration - we handle auth manually inside the function
[functions.fireflies-sync]
verify_jwt = false

# Google Calendar webhook - receives push notifications from Google Calendar API
# Google sends unauthenticated requests, we verify via channel_id in database
[functions.google-calendar-webhook]
verify_jwt = false

# Google Calendar sync - called by webhook to perform incremental sync
# Webhook calls this internally, so needs to bypass JWT verification
[functions.google-calendar-sync]
verify_jwt = false

# MeetingBaaS webhook - receives push notifications from MeetingBaaS API
# External service sends unauthenticated requests, we verify via signature
[functions.meetingbaas-webhook]
verify_jwt = false

# Process recording - called internally by meetingbaas-webhook
# Triggered by webhook handler, so no JWT verification needed
[functions.process-recording]
verify_jwt = false

# Poll stuck bots - fallback for missed MeetingBaaS webhooks
# Called internally or via cron, uses service role key for auth
[functions.poll-stuck-bots]
verify_jwt = false

# MeetingBaaS Connect Calendar - called from frontend with user JWT
# We handle auth verification manually inside the function
[functions.meetingbaas-connect-calendar]
verify_jwt = false

# Company logo fetcher - public utility function, no auth needed
# Fetches logos from logo.dev and caches in S3
[functions.fetch-company-logo]
verify_jwt = false

# Integration config functions - called from browser with user JWT
# We handle auth verification manually inside the functions (CORS preflight needs to work)
[functions.justcall-config]
verify_jwt = false

[functions.savvycal-config]
verify_jwt = false

[functions.hubspot-admin]
verify_jwt = false

# OAuth initiate functions - called from browser to start OAuth flows
# Handle auth internally (CORS preflight needs to work)
[functions.google-oauth-initiate]
verify_jwt = false

[functions.hubspot-oauth-initiate]
verify_jwt = false

# Fathom integration - called from browser, handle auth internally
# OAuth initiate/callback + sync/disconnect + user mapping
[functions.fathom-oauth-initiate]
verify_jwt = false

[functions.fathom-oauth-callback]
verify_jwt = false

[functions.fathom-sync]
verify_jwt = false

[functions.fathom-disconnect]
verify_jwt = false

[functions.fathom-self-map]
verify_jwt = false

[functions.fathom-update-user-mapping]
verify_jwt = false

[functions.fetch-transcript]
verify_jwt = false

[functions.backfill-transcripts]
verify_jwt = false

# Thumbnail generation - called internally by fathom-sync and backfill-thumbnails
[functions.generate-video-thumbnail-v2]
verify_jwt = false

[functions.backfill-thumbnails]
verify_jwt = false

# Deploy recording bot - called from browser with user JWT
# We handle auth verification manually inside the function (CORS preflight needs to work)
[functions.deploy-recording-bot]
verify_jwt = false

# Get recording URL - called from browser to fetch signed S3 URL for video playback
# We handle auth verification manually inside the function (CORS preflight needs to work)
[functions.get-recording-url]
verify_jwt = false

# Password reset email - called from admin panel with user JWT
# We handle auth verification manually inside the function (CORS preflight needs to work)
[functions.send-password-reset-email]
verify_jwt = false
