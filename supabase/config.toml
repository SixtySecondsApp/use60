# Supabase Project Configuration
# This file is used by Supabase CLI for local development and branching

[project]
# Project reference ID - set via: supabase link --project-ref <id>
# project_id = "your-project-ref-id"

# Database Configuration
[db]
# Connection pooler settings for branching
# Development branch uses connection pooler for better performance
pooler = { enabled = true, port = 6543, pool_mode = "transaction" }

[functions.process-single-activity]
enabled = true
verify_jwt = true
# import_map = "./functions/process-single-activity/deno.json"
# Uncomment to specify a custom file path to the entrypoint.
# Supported file extensions are: .ts, .js, .mjs, .jsx, .tsx
entrypoint = "./functions/process-single-activity/index.ts"
# Specifies static files to be bundled with the function. Supports glob patterns.
# For example, if you want to serve static HTML pages in your function:
# static_files = [ "./functions/process-single-activity/*.html" ]

[functions.savvycal-leads-webhook]
verify_jwt = false

# JustCall integration (webhooks + OAuth callback must accept non-JWT requests)
[functions.justcall-webhook]
verify_jwt = false

[functions.justcall-oauth-callback]
verify_jwt = false

# Audio proxy is consumed by <audio> tags (Range requests) so we allow token via query string
[functions.proxy-justcall-recording]
verify_jwt = false

[functions.justcall-search]
verify_jwt = false

# Internal automation triggered by webhooks / server-side jobs.
# We disable platform JWT verification and enforce auth inside the function
# (service role bearer token, optional CRON_SECRET, or user JWT checks).
[functions.process-lead-prep]
verify_jwt = false

[functions.enrich-company]
verify_jwt = false

# HubSpot integration (OAuth callback + webhooks must accept non-JWT requests)
[functions.hubspot-oauth-callback]
verify_jwt = false

[functions.hubspot-webhook]
verify_jwt = false

# Health check endpoint - public access for monitoring services
[functions.health]
verify_jwt = false

# Copilot (called directly from browser; must allow CORS preflight without platform JWT gate)
[functions.api-copilot]
verify_jwt = false

# Gmail (called directly from browser; uses in-function auth + allowlist-based CORS)
[functions.google-gmail]
verify_jwt = false

# Slack interactive webhooks (buttons, modals) - uses Slack signature verification
[functions.slack-interactive]
verify_jwt = false

# HITL test endpoint - for testing approval flows
[functions.test-hitl]
verify_jwt = false

# Fireflies integration - we handle auth manually inside the function
[functions.fireflies-sync]
verify_jwt = false

# Google Calendar API - called from browser to sync/manage calendar
# Handle auth internally (CORS preflight needs to work)
[functions.google-calendar]
verify_jwt = false

# Google test connection - verifies Google API access for various services
[functions.google-test-connection]
verify_jwt = false

# Google Tasks API - manages user tasks
[functions.google-tasks]
verify_jwt = false

# Google Docs API - reads/writes documents
[functions.google-docs]
verify_jwt = false

[functions.google-docs-create]
verify_jwt = false

# Google Drive API - file management
[functions.google-drive]
verify_jwt = false

# Google Workspace batch operations
[functions.google-workspace-batch]
verify_jwt = false

# Google Calendar webhook - receives push notifications from Google Calendar API
# Google sends unauthenticated requests, we verify via channel_id in database
[functions.google-calendar-webhook]
verify_jwt = false

# Google Calendar sync - called by webhook to perform incremental sync
# Webhook calls this internally, so needs to bypass JWT verification
[functions.google-calendar-sync]
verify_jwt = false

# MeetingBaaS webhook - receives push notifications from MeetingBaaS API
# External service sends unauthenticated requests, we verify via signature
[functions.meetingbaas-webhook]
verify_jwt = false

# Deploy recording bot - called from browser with user JWT
# We handle auth verification manually inside the function (CORS preflight needs to work)
[functions.deploy-recording-bot]
verify_jwt = false

# Stop recording bot - called from browser with user JWT
# We handle auth verification manually inside the function (CORS preflight needs to work)
[functions.stop-recording-bot]
verify_jwt = false

# Get recording URL - called from browser with user JWT
# We handle auth verification manually inside the function (CORS preflight needs to work)
[functions.get-recording-url]
verify_jwt = false

# Process recording - called internally by meetingbaas-webhook
# Triggered by webhook handler, so no JWT verification needed
[functions.process-recording]
verify_jwt = false

# MeetingBaaS Connect Calendar - called from frontend with user JWT
# We handle auth verification manually inside the function
[functions.meetingbaas-connect-calendar]
verify_jwt = false

# Company logo fetcher - public utility function, no auth needed
# Fetches logos from logo.dev and caches in S3
[functions.fetch-company-logo]
verify_jwt = false

# Integration config functions - called from browser with user JWT
# We handle auth verification manually inside the functions (CORS preflight needs to work)
[functions.justcall-config]
verify_jwt = false

[functions.savvycal-config]
verify_jwt = false

[functions.hubspot-admin]
verify_jwt = false

# OAuth initiate functions - called from browser to start OAuth flows
# Handle auth internally (CORS preflight needs to work)
[functions.google-oauth-initiate]
verify_jwt = false

# OAuth exchange function - exchanges code for tokens
# Called from browser with user JWT, handles auth manually (CORS preflight needs to work)
[functions.google-oauth-exchange]
verify_jwt = false

[functions.hubspot-oauth-initiate]
verify_jwt = false

# Password reset email - called from admin panel with user JWT
# We handle auth verification manually inside the function (CORS preflight needs to work)
[functions.send-password-reset-email]
verify_jwt = false

# Process Lambda compression callback - receives HMAC-signed results from AWS Lambda
# Uses X-Callback-Signature header for auth (not JWT)
[functions.process-compress-callback]
verify_jwt = false

# Generate S3 video thumbnail - called internally by process-recording
# Uses service role key for auth
[functions.generate-s3-video-thumbnail]
verify_jwt = false

# Sync recording to CRM - called internally by process-recording
# Uses service role key for auth
[functions.sync-recording-to-crm]
verify_jwt = false

# Stages API - called from browser with user JWT
# Uses service role key internally (CORS preflight needs to work)
[functions.stages]
verify_jwt = false

# Process Gladia webhook - receives async transcription results
# Called by Gladia API (external webhook) - no JWT verification needed
[functions.process-gladia-webhook]
verify_jwt = false

# Process AI analysis - triggered after transcription completes
# Called internally by process-gladia-webhook - no JWT verification needed
[functions.process-ai-analysis]
verify_jwt = false

# Poll Gladia jobs - scheduled cron job that checks for completed transcriptions
# Runs every 3 minutes to poll Gladia API (since webhooks don't work)
# Called by Supabase cron scheduler - no JWT verification needed
# The cron schedule is managed via SQL function: supabase/migrations/*_poll_gladia_cron.sql
[functions.poll-gladia-jobs]
verify_jwt = false

# Fathom integration - all functions handle auth internally
# OAuth callback is called by Fathom redirect (no JWT)
[functions.fathom-oauth-callback]
verify_jwt = false

# OAuth initiate - called from browser with user JWT (CORS preflight needs to work)
[functions.fathom-oauth-initiate]
verify_jwt = false

# Fathom sync - called from browser or cron, handles auth internally
[functions.fathom-sync]
verify_jwt = false

# Fathom cron sync - triggered by scheduler
[functions.fathom-cron-sync]
verify_jwt = false

# Fathom disconnect - called from browser with user JWT
[functions.fathom-disconnect]
verify_jwt = false

# Fathom webhook - receives push notifications from Fathom API
[functions.fathom-webhook]
verify_jwt = false

# Fathom token refresh - internal token management
[functions.fathom-token-refresh]
verify_jwt = false

# Fathom user mapping - called from browser with user JWT
[functions.fathom-update-user-mapping]
verify_jwt = false

# Fathom self-map - called from browser with user JWT
[functions.fathom-self-map]
verify_jwt = false

# Fathom backfill companies - internal batch operation
[functions.fathom-backfill-companies]
verify_jwt = false

# Fathom transcript retry - cron/internal retry mechanism
[functions.fathom-transcript-retry]
verify_jwt = false

# Fathom test utilities - called from browser with user JWT
[functions.test-fathom-token]
verify_jwt = false

[functions.test-fathom-api]
verify_jwt = false

# Analytics web vitals - called from browser, no auth needed for telemetry
[functions.analytics-web-vitals]
verify_jwt = false

# Org capabilities check - called from browser with user JWT
# We handle auth verification manually inside the function (CORS preflight needs to work)
[functions.check-org-capabilities]
verify_jwt = false

# Autonomous copilot - called from browser with user JWT
# We handle auth verification manually inside the function (CORS preflight needs to work)
[functions.copilot-autonomous]
verify_jwt = false

# Validate waitlist magic token - called from browser without user JWT
# This is a public endpoint for the signup flow, no authentication required
# We handle validation by checking token existence and expiry in the database
[functions.validate-waitlist-token]
verify_jwt = false

# Delete organization - called from admin panel with user JWT
# We handle auth verification manually inside the function (admin check)
[functions.delete-organization]
verify_jwt = false

# Cleanup incomplete onboarding - scheduled/manual cleanup of abandoned org records
# Called by pg_cron or admin trigger with CRON_SECRET or service role key
[functions.cleanup-incomplete-onboarding]
verify_jwt = false
